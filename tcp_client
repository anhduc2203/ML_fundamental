#include <stdio.h>
#include <conio.h>
#define _WINSOCK_DEPRECATED_NO_WARNINGS
#include "winsock2.h"
#include <Windows.h>
int main(int argc, char*argv[])
{
	WSAData wsa;
	WSAStartup(MAKEWORD(2, 2), &wsa);

	//Thiet lap socket phia client
	SOCKET client = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
	system("PAUSE");
	SOCKADDR_IN serverAddr;
	serverAddr.sin_family = AF_INET;
	serverAddr.sin_addr.s_addr = inet_addr(argv[1]);// argv[1] là địa chỉ ip truyền vào
	serverAddr.sin_port = htons(int(argv[2]));// argv[2] là cổng kết nối đến server
	
	int ret = connect(client, (SOCKADDR*)&serverAddr, sizeof(serverAddr));
	
	if (ret == SOCKET_ERROR) {
		ret = WSAGetLastError();
		return 1;
	}
	
	system("PAUSE");
	const char *mess = "Hello server, please connect!";
	send(client, mess, strlen(mess), 0);
	
	
	//
	char buffer[256];
	while (TRUE) {
		printf("\nNhap thong diep gui den server: ");
		gets_s(buffer);

		send(client, buffer, strlen(buffer), 0);
		send(client, "\n", 1, 0);
	}

	
	closesocket(client);
	
	
	system("PAUSE");
	WSACleanup();

	return 0;

}
